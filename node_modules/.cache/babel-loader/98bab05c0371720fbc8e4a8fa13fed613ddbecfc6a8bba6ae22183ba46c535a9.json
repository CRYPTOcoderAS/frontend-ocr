{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{Modal,Button,Table,Form}from\"react-bootstrap\";import EditModal from\"../components/EditModal\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const HistoryModal=_ref=>{let{show,onHide}=_ref;const[historyData,setHistoryData]=useState([]);const[filteredData,setFilteredData]=useState([]);const[loading,setLoading]=useState(true);const[searchTerm,setSearchTerm]=useState(\"\");const[idNumber,setIdNumber]=useState();const[modalEdit,setModalEditShow]=useState(false);useEffect(()=>{const fetchData=async()=>{try{const response=await axios.get(\"https://thai-card.onrender.com/api/citizen/\");setHistoryData(response.data);setLoading(false);}catch(error){console.error(\"Error fetching history data:\",error.message);setLoading(false);}};if(show){fetchData();}},[show]);useEffect(()=>{// Filter data based on search term\nconst filtered=historyData.filter(item=>Object.values(item).some(value=>value.toString().toLowerCase().includes(searchTerm.toLowerCase())));setFilteredData(filtered);},[searchTerm,historyData]);const handleDelete=async identification_number=>{try{await axios.delete(\"https://thai-card.onrender.com/api/citizen/\".concat(identification_number));const updatedData=filteredData.filter(item=>item.identification_number!==identification_number);setFilteredData(updatedData);}catch(error){console.error(\"Error during data deletion:\",error.message);}};const handleEdit=async identification_number=>{setIdNumber(identification_number);setModalEditShow(true);};const handleSave=async identification_number=>{try{// Assuming you have an API endpoint to get data by identification number\nconst response=await axios.get(\"https://thai-card.onrender.com/api/citizen/\".concat(identification_number));// Convert the response object to an array\nconst dataArray=Object.values(response.data);// Update the modal data or any state you need\nsetHistoryData(dataArray);onHide();// Close the modal or perform any other actions\n}catch(error){console.error(\"Error fetching data:\",error.message);// Handle errors or display a message to the user\n}};return/*#__PURE__*/_jsxs(Modal,{show:show,onHide:onHide,centered:true,size:\"xl\"// set the size to large\n,dialogClassName:\"custom-modal\",children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"History\"})}),/*#__PURE__*/_jsxs(Modal.Body,{children:[/*#__PURE__*/_jsxs(Form.Group,{controlId:\"searchTerm\",children:[/*#__PURE__*/_jsx(Form.Label,{children:\"Search:\"}),/*#__PURE__*/_jsx(Form.Control,{type:\"text\",placeholder:\"Enter search term\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value)})]}),/*#__PURE__*/_jsx(EditModal,{show:modalEdit,onHide:()=>setModalEditShow(false),idNumber:idNumber,setIdNumber:setIdNumber}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading history data...\"}):/*#__PURE__*/_jsxs(Table,{striped:true,bordered:true,hover:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID Number\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Last Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date of Birth\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date of Issue\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date of Expiry\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:filteredData.map(item=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:item.identification_number}),/*#__PURE__*/_jsx(\"td\",{children:item.name}),/*#__PURE__*/_jsx(\"td\",{children:item.last_name}),/*#__PURE__*/_jsx(\"td\",{children:item.date_of_birth}),/*#__PURE__*/_jsx(\"td\",{children:item.date_of_issue}),/*#__PURE__*/_jsx(\"td\",{children:item.date_of_expiry}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Button,{variant:\"info\",onClick:()=>handleEdit(item.identification_number),children:\"Edit\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Button,{variant:\"danger\",onClick:()=>handleDelete(item.identification_number),children:\"Delete\"})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Button,{variant:\"warning\",onClick:()=>handleSave(item.identification_number),children:\"save\"})})]},item._id))})]})]}),/*#__PURE__*/_jsx(Modal.Footer,{children:/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:onHide,children:\"Close\"})})]});};export default HistoryModal;","map":{"version":3,"names":["React","useState","useEffect","Modal","Button","Table","Form","EditModal","axios","jsx","_jsx","jsxs","_jsxs","HistoryModal","_ref","show","onHide","historyData","setHistoryData","filteredData","setFilteredData","loading","setLoading","searchTerm","setSearchTerm","idNumber","setIdNumber","modalEdit","setModalEditShow","fetchData","response","get","data","error","console","message","filtered","filter","item","Object","values","some","value","toString","toLowerCase","includes","handleDelete","identification_number","delete","concat","updatedData","handleEdit","handleSave","dataArray","centered","size","dialogClassName","children","Header","closeButton","Title","Body","Group","controlId","Label","Control","type","placeholder","onChange","e","target","striped","bordered","hover","map","name","last_name","date_of_birth","date_of_issue","date_of_expiry","variant","onClick","_id","Footer"],"sources":["C:/Users/Dell/Desktop/frontend-ocr/src/components/History.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { Modal, Button, Table, Form } from \"react-bootstrap\";\r\nimport EditModal from \"../components/EditModal\";\r\nimport axios from \"axios\";\r\n\r\nconst HistoryModal = ({ show, onHide }) => {\r\n  const [historyData, setHistoryData] = useState([]);\r\n  const [filteredData, setFilteredData] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [idNumber, setIdNumber] = useState()\r\n  const [modalEdit, setModalEditShow] = useState(false);\r\n\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const response = await axios.get(\r\n          \"https://thai-card.onrender.com/api/citizen/\"\r\n        );\r\n        setHistoryData(response.data);\r\n        setLoading(false);\r\n      } catch (error) {\r\n        console.error(\"Error fetching history data:\", error.message);\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    if (show) {\r\n      fetchData();\r\n    }\r\n  }, [show]);\r\n\r\n  useEffect(() => {\r\n    // Filter data based on search term\r\n    const filtered = historyData.filter((item) =>\r\n      Object.values(item).some((value) =>\r\n        value.toString().toLowerCase().includes(searchTerm.toLowerCase())\r\n      )\r\n    );\r\n    setFilteredData(filtered);\r\n  }, [searchTerm, historyData]);\r\n\r\n  const handleDelete = async (identification_number) => {\r\n    try {\r\n      await axios.delete(\r\n        `https://thai-card.onrender.com/api/citizen/${identification_number}`\r\n      );\r\n      const updatedData = filteredData.filter(\r\n        (item) => item.identification_number !== identification_number\r\n      );\r\n      setFilteredData(updatedData);\r\n    } catch (error) {\r\n      console.error(\"Error during data deletion:\", error.message);\r\n    }\r\n  };\r\n\r\n  const handleEdit = async (identification_number) => {\r\n\r\n    setIdNumber(identification_number)\r\n    setModalEditShow(true);\r\n  };\r\n  \r\n  const handleSave = async (identification_number) => {\r\n    try {\r\n      // Assuming you have an API endpoint to get data by identification number\r\n      const response = await axios.get(`https://thai-card.onrender.com/api/citizen/${identification_number}`);\r\n  \r\n      // Convert the response object to an array\r\n      const dataArray = Object.values(response.data);\r\n  \r\n      // Update the modal data or any state you need\r\n      setHistoryData(dataArray);\r\n  \r\n      onHide()\r\n      // Close the modal or perform any other actions\r\n    } catch (error) {\r\n      console.error(\"Error fetching data:\", error.message);\r\n      // Handle errors or display a message to the user\r\n    }\r\n  };\r\n  \r\n  \r\n\r\n  return (\r\n    <Modal\r\n      show={show}\r\n      onHide={onHide}\r\n      centered\r\n      size=\"xl\" // set the size to large\r\n      dialogClassName=\"custom-modal\"\r\n    >\r\n      <Modal.Header closeButton>\r\n        <Modal.Title>History</Modal.Title>\r\n      </Modal.Header>\r\n      <Modal.Body>\r\n        <Form.Group controlId=\"searchTerm\">\r\n          <Form.Label>Search:</Form.Label>\r\n          <Form.Control\r\n            type=\"text\"\r\n            placeholder=\"Enter search term\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n          />\r\n        </Form.Group>\r\n        <EditModal\r\n            show={modalEdit}\r\n            onHide={() => setModalEditShow(false)}\r\n            idNumber={idNumber}\r\n            setIdNumber={setIdNumber}\r\n          />\r\n        {loading ? (\r\n          <p>Loading history data...</p>\r\n        ) : (\r\n          <Table striped bordered hover>\r\n            <thead>\r\n              <tr>\r\n                <th>ID Number</th>\r\n                <th>Name</th>\r\n                <th>Last Name</th>\r\n                <th>Date of Birth</th>\r\n                <th>Date of Issue</th>\r\n                <th>Date of Expiry</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {filteredData.map((item) => (\r\n                <tr key={item._id}>\r\n                  <td>{item.identification_number}</td>\r\n                  <td>{item.name}</td>\r\n                  <td>{item.last_name}</td>\r\n                  <td>{item.date_of_birth}</td>\r\n                  <td>{item.date_of_issue}</td>\r\n                  <td>{item.date_of_expiry}</td>\r\n                  <td>\r\n                    <Button variant=\"info\" onClick={() => handleEdit(item.identification_number)}>\r\n                      Edit\r\n                    </Button>\r\n                  </td>\r\n                  <td>\r\n                    <Button\r\n                      variant=\"danger\" onClick={() => handleDelete(item.identification_number)}>\r\n                      Delete\r\n                    </Button>\r\n                  </td>\r\n                  <td>\r\n                    <Button variant=\"warning\" onClick={() => handleSave(item.identification_number)}>\r\n                      save\r\n                    </Button>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </Table>\r\n        )}\r\n      </Modal.Body>\r\n      <Modal.Footer>\r\n        <Button variant=\"secondary\" onClick={onHide}>\r\n          Close\r\n        </Button>\r\n      </Modal.Footer>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default HistoryModal;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}